<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì—°ì•  ì‹œë®¬ë ˆì´ì…˜</title>
  <style>
/* ê³µí†µ ì„¤ì • */
* {margin: 0;padding: 0;box-sizing: border-box;}

/* í°íŠ¸ */
@font-face {
  font-family: 'DungGeunMo';
  src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_six@1.2/DungGeunMo.woff') format('woff');
  font-weight: normal;
  font-style: normal;
}

body, html {
  height: 100%;
  width: 100%;
  background: #008080;
  font-family: 'Courier New', monospace;
}

/* ê¸°ë³¸ ì°½ êµ¬ì„± */
.window-frame {
  position: relative;
  width: 800px;
  height: 600px;
  margin: 30px auto;
  border: 3px solid #F7F7F7;
  box-shadow: 8px 8px 0 #404040;
  background: #c0c0c0;
  display: flex;
  flex-direction: column;
}

.title-bar {
  background: #000080;
  color: #fff;
  padding: 6px 12px;
  font: normal 12px 'DungGeunMo', monospace;
}

.content-area {
  position: relative;
  flex: 1;
  overflow: hidden;
}

/* ë°°ê²½ ì´ë¯¸ì§€ ì„¤ì • */
.blur-bg {
  filter: blur(4px);
  position: absolute;
  max-height: 100%;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  object-fit: contain;
  z-index: 0;
}

.no-blur {
  filter: none;
  position: absolute;
  max-height: 100%;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  object-fit: contain;
  z-index: 0;
}

/* ìƒíƒœ íŒ¨ë„ (í˜¸ê°ë„ ë“±) */
.status-panel {
  position: absolute;
  top: 10px;
  left: 10px;
  background: rgba(0,0,0,0.5);
  color: #fff;
  padding: 8px 12px;
  border: 1px solid #fff;
  font: 14px/1.4 'DungGeunMo', monospace;
  z-index: 10;
  width: 160px;
}

.affection {
  margin-top: 6px;
  cursor: pointer;
}

.affection-bar {
  width: 100%;
  height: 8px;
  background: #333;
  border: 1px solid #aaa;
  margin-top: 4px;
}

.affection-fill {
  height: 100%;
  background: #ff5e99;
  transition: width 0.4s ease;
}

/* í˜¸ê°ë„ ì„¤ëª… íŒì—… */
.affection-info-window {
  position: absolute;
  top: 180px;
  left: 20px;
  width: 280px;
  background: #c0c0c0;
  border: 3px solid #808080;
  box-shadow: 4px 4px 0 #404040;
  font-family: 'DungGeunMo', monospace;
  z-index: 20;
}

.popup-title {
  background: #000080;
  color: #fff;
  padding: 4px 8px;
  font: 14px 'DungGeunMo', monospace;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.popup-close {
  cursor: pointer;
}

.popup-content {
  padding: 12px;
  background: #e0e0e0;
  color: #000;
  font: 13px 'DungGeunMo', monospace;
}

/* ìºë¦­í„° ì´ë¯¸ì§€ */
.character {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  height: 100%;
  max-height: 100%;
  object-fit: contain;
  z-index: 4;
}

/* ëŒ€í™”ì°½ */
.dialogue-box {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 120px; 
  background: rgba(0,0,0,0.7);
  color: #fff;
  padding: 16px 20px;
  font-size: 16px;
  line-height: 1.5;
  border-top: 2px solid #fff;
  z-index: 10;
  font-family: 'DungGeunMo', monospace;
}

.character-name {
  font-weight: bold;
  color: #0ff;
  margin-bottom: 6px;
}

.next-button {
  display: inline-block;
  margin-top: 10px;
  color: #ff0;
  cursor: pointer;
  font: bold 18px 'DungGeunMo', monospace;
}

/* ì–´ë‘ìš´ í™”ë©´ ì—°ì¶œ (ì»·ì‹  ë“±) */
.dim-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.6);
  z-index: 5;
  display: none;
}

/* ì„ íƒì§€ ë°•ìŠ¤ */
#choiceBox {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-family: 'DungGeunMo', monospace;
  z-index: 30;
  flex-direction: column;
  gap: 12px;
  align-items: center;
}

#choiceBox button {
  padding: 12px 20px;
  background: rgba(0, 0, 0, 0.7);
  border: 2px solid #fff;
  color: #fff;
  font-family: 'DungGeunMo', monospace;
  font-size: 16px;
  cursor: pointer;
  width: 300px;
  text-align: center;
  transition: background 0.2s;
}

#choiceBox button:hover {
  background: rgba(0, 0, 0, 0.2);
}

/* ì‚¬ì´ë“œ ë²„íŠ¼ ì˜ì—­ (ë©”ëª¨ì¥ ë“±) */
.side-buttons {
  position: fixed;
  top: 10px;
  left: 10px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  z-index: 50;
}

.side-buttons button {
  width: 60px;
  background: transparent;
  border: none;
  padding: 0;
  cursor: pointer;
}

.side-buttons img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* ë©”ëª¨ì¥ íŒì—… */
.notepad-popup {
  position: absolute;
  top: 80px;
  left: 100px;
  width: 320px;
  background: #F7F7F7;
  border: 3px solid #F7F7F7;
  box-shadow: 4px 4px 0 #404040;
  font-family: 'DungGeunMo', monospace;
  z-index: 999;
}

.notepad-popup .popup-title {
  background: #000080;
  color: white;
  padding: 6px 10px;
  font-size: 14px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.notepad-popup .popup-close {
  cursor: pointer;
}

.notepad-popup .popup-content {
  padding: 12px;
  background: #e0e0e0;
  color: black;
  font-size: 13px;
  line-height: 1.5;
}

  </style>
</head>
<body>

<!-- âš™ï¸ ì‚¬ì´ë“œ ë²„íŠ¼ë“¤ (ì¢Œì¸¡ ê³ ì •) -->
<div class="side-buttons">
  <button onclick="location.href='info.html'"><img src="ì´ë¯¸ì§€/ë‚´ì»´í“¨í„°.png" alt="ë‚´ ì»´í“¨í„°"></button>
  <button><img src="ì´ë¯¸ì§€/ì¸í„°ë„·.png" alt="ì¸í„°ë„·"></button>
  <button><img src="ì´ë¯¸ì§€/ë©”ëª¨ì¥.png" alt="ë©”ëª¨ì¥"></button>
  <button><img src="ì´ë¯¸ì§€/í´ë”.png" alt="í´ë”"></button>
  <button onclick="location.href='home.html'"><img src="ì´ë¯¸ì§€/íœ´ì§€í†µ.png" alt="íœ´ì§€í†µ"></button>
  <button onclick="location.href='index.html'"><img src="ì´ë¯¸ì§€/ì¹´ë¼ì–‘ì–‘.png" alt="ì¹´ë¼ì–‘ì–‘"></button>
</div>

<!-- ğŸ–¥ ë©”ì¸ ê²Œì„ í™”ë©´ -->
<div class="window-frame">
  <div class="title-bar">ğŸ’¾ ìƒì–´ë²„ë¦° ëˆˆ ì°¾ê¸° ëŒ€-ì†Œ-ë™!</div>
  <div class="content-area">
    <!-- ë°°ê²½ ì´ë¯¸ì§€ -->
    <img id="background" src="ì´ë¯¸ì§€/ë°°ê²½.png" class="blur-bg" alt="ë°°ê²½">

    <!-- ìºë¦­í„° ì´ë¯¸ì§€ -->
    <img id="charImg" class="character" src="ì´ë¯¸ì§€/ì´ˆê¸°.png" alt="ìºë¦­í„°">

    <!-- ì–´ë‘ìš´ í™”ë©´ ì˜¤ë²„ë ˆì´ -->
    <div id="dimOverlay" class="dim-overlay"></div>

    <!-- ë°°ê²½ ìŒì•… (ìˆ¨ê¹€) -->
    <iframe width="0" height="0" 
      src="https://www.youtube.com/embed/wefAT9LZ_BM?autoplay=1&loop=1&playlist=wefAT9LZ_BM" 
      frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

    <!-- ìƒíƒœ í‘œì‹œ (ë‚ ì§œ/í˜¸ê°ë„) -->
    <div class="status-panel" id="statusPanel">
      <div id="gameDate">13ì›” 7ì¼</div>
      <div id="affection" class="affection">
        í˜¸ê°ë„ â™¥ <span id="affectionValue">5</span>
        <div class="affection-bar">
          <div id="affectionFill" class="affection-fill" style="width:5%"></div>
        </div>
      </div>
    </div>

    <!-- í˜¸ê°ë„ íŒì—… ì •ë³´ì°½ -->
    <div id="affectionInfo" class="affection-info-window" style="display:none;">
      <div class="popup-title">ğŸ’¬ í˜¸ê°ë„ ì •ë³´ <span id="closeAffectionInfo" class="popup-close">X</span></div>
      <div id="affectionInfoContent" class="popup-content"></div>
    </div>

    <!-- ëŒ€í™”ì°½ -->
    <div class="dialogue-box" id="dialogueBox">
      <div id="charName" class="character-name">ì–‘ì–‘</div>
      <div id="dialogueText" class="dialogue-text">ì‹œì‘ ëŒ€ì‚¬</div>
      <div id="nextBtn" class="next-button">â–¼</div>
    </div>

    <!-- ì„ íƒì§€ ë°•ìŠ¤ -->
    <div id="choiceBox"></div>
  </div>
</div>

  <!-- ğŸ“ ë©”ëª¨ì¥ íŒì—… -->
<div id="notepadPopup" class="notepad-popup" style="display:none;">
  <div class="popup-title">ğŸ“ ì œëª© ì—†ìŒ <span id="closeNotepad" class="popup-close">X</span></div>
  <div class="popup-content">
    ë‚´ ì»´í“¨í„°ë¥¼ ëˆ„ë¥´ë©´ ìºë¦­í„° ì •ë³´ë¥¼ í™•ì¸.<br>
    íœ´ì§€í†µì„ ëˆ„ë¥´ë©´ ì‹œë®¬ë ˆì´ì…˜ ì´ˆê¸°í™”.<br>
    í˜ì–´ ì•„ì´ì½˜ì„ ëˆ„ë¥´ë©´ ë©”ì¸ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.
  </div>
</div>

<!-- ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘ -->
<script>
// ë©”ëª¨ì¥ íŒì—… ê´€ë ¨
const notepadPopup = document.getElementById('notepadPopup');
const closeNotepad = document.getElementById('closeNotepad');
const memoBtn = document.querySelector('img[alt="ë©”ëª¨ì¥"]').parentElement;

memoBtn.addEventListener('click', () => {
  notepadPopup.style.display = 'block';
});
closeNotepad.addEventListener('click', () => {
  notepadPopup.style.display = 'none';
});

// ê¸°ë³¸ ë³€ìˆ˜ë“¤
let index = 0;
let affection = 5;
let choiceShown = false;

// ëŒ€ì‚¬ ë°°ì—´
let dialogues = [
  { name: '-', text: 'í‰í™”ë¡œìš´ í•˜ëŠ˜ ìœ„' },
  { name: '-', text: 'ì•½ì† ì‹œê°„ì´ ë‹¤ ë˜ì—ˆê±´ë§Œ í†µ ì˜¤ì§ˆ ì•ŠëŠ” ì•…ë§ˆ í•˜ë‚˜ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘ì´ë‹¤.' },
  { name: '-', text: 'í‰ì†Œì—ëŠ” íœ´ëŒ€ìš© í†µì‹ ê¸°ê¸°ë¡œ ê³§ì˜ ë– ë“¤ì–´ëŒ€ë”ë‹ˆ ì™œ ì´ëŸ´ ë•Œë§Œ ì•„ë¬´ ì†Œì‹ì´ ì—†ëŠ”ì§€.' },
  { name: '-', text: 'ë‹µë‹µí–ˆì§€ë§Œ í†µì‹ ê¸°ê¸°ë¡œ ë¨¼ì € ë§ì„ ê±°ëŠ” ê±´ ë‚´í‚¤ì§€ ì•Šì•˜ë‹¤.' },
  { name: '-', text: 'ì´ëŒ€ë¡œ ì˜¤ë§ˆì—ì™€ ì‹œê°„ì„ ë³´ë‚´ëŠ” ê²ƒë„ ì¢‹ì•˜ìœ¼ë‹ˆê¹Œ.' },
  { name: '-', text: 'ë§Œì§€ì‘ ë³´ë“¤ë³´ë“¤ ì“°ë‹´ì“°ë‹´ ë³µë³µ' },
  { name: '-', text: 'í•œì°¸ ì†ê¸¸ì„ ë”°ë¼ í’ˆì†ì—ì„œ ê¾¸ë¬¼ê±°ë¦¬ë˜ ì˜¤ë§ˆì—ê°€ ëë‚´ ì ì— ë“¤ë ¤ëŠ” ìˆœê°„' },
  { name: '??', text: 'ì¹´ë¼ì‚¬í‚¤ ë‹˜...---!!' },
  { name: '-', text: 'ìµìˆ™í•œ ëª©ì†Œë¦¬ê°€ ë‹¤ê¸‰í•˜ê²Œ ì´ë¦„ì„ ë¶€ë¥¸ë‹¤.' },
  { name: '-', text: 'â€¦ ì–´ë–»ê²Œ í•˜ì§€?', choice: true },
];

// ë¶„ê¸° ì‹œë‚˜ë¦¬ì˜¤ë“¤
const branchA = [
  { name: '-', text: 'ì•½ì†ì— ëŠ¦ì—ˆìœ¼ë©´ ì¬ê¹ ì˜¬ ê²ƒì¸ì§€ ì–´ë””ì„œ ë¶€ë¥´ëŠ” ê±´ì§€.'},
  { name: '-', text: 'ì ì—ì„œ ê¹¨ë²„ë¦° ì˜¤ë§ˆì—ë¥¼ ì–´ì™€ ë‘¥ë‘¥ ë‹¬ë˜ì£¼ë©´ì„œ ê¸°ë‹¤ë¦¬ê¸°ë¡œ í–ˆë‹¤.' },
  { name: '-', text: 'ì•„ì´ê·€ì—¬ì›Œ!'},
  { name: 'SYSTEM', text: 'ê·¸ í›„ë¡œ ì–‘ì–‘ì´ëŠ” ë‹¹ìµœ ì–´ë””ì— ìˆëŠ”ì§€ ë³´ì´ì§€ ì•Šì•˜ë‹¤.',
    img: 'ì´ë¯¸ì§€/ê²Œì„ì˜¤ë²„.png', end: true },
];

const branchB = [
  { name: '-', text: 'ì¼ë‹¨ ê¹¨ì–´ë‚œ ì˜¤ë§ˆì—ë¥¼ í† ë‹¥ì´ë©° ì•ˆì•„ë“¤ê³  ë‹¤ê¸‰í•œ ëª©ì†Œë¦¬ë¥¼ ë”°ë¼ê°”ë‹¤.'},
  { name: '-', text: 'ë©€ì§€ ì•Šì€ ê³³ì— ìµìˆ™í•œ ë±€ì´ ë§ˆì¤‘ì„ ë‚˜ì˜¨ ê²ƒì²˜ëŸ¼ ì•ì— ë‚˜íƒ€ë‚¬ê³ ,' },
  { name: '-', text: 'ê·¸ ë’¤ë¡œ ì£¼ì € ì•‰ì•„ìˆëŠ” ì–‘ì–‘ì´ ë³´ì˜€ë‹¤.', bg: 'ì´ë¯¸ì§€/ì»·ì”¬.png' }, 
  { name: 'ì–‘ì–‘', text: 'ì¹´ë¼ì‚¬í‚¤ ë‹˜, ì¹´ë¼ì‚¬í‚¤ ë‹˜ì¸ê°€ìš”?' }, 
  { name: 'ì¹´ë¼ì‚¬í‚¤', text: 'ê±°ê¸°ì„œ ì™œ ê·¸ëŸ¬ê³  ìˆëŠ” ê±°ëƒ.' },
  { name: 'ì–‘ì–‘', text: 'í°ì¼ì´ì—ìš”...! ì €, ëˆˆì„ ìƒì–´ë²„ë ¸ë‹¤êµ¬ìš”...!?', bg: 'ì´ë¯¸ì§€/ë°°ê²½.png', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' },
  { name: '-', text: 'ì–‘ì–‘ì˜ ëˆˆì´ë¼ í•˜ë©´ ì´ë¯¸ ìƒì–´ë²„ë¦°ì§€ ì˜¤ë˜ ì•„ë‹ˆì—ˆë‚˜?', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' }, 
  { name: 'ì–‘ì–‘', text: 'í•˜ëŠ˜ ìœ„ ê³µê¸°ê°€ ìµìˆ™í•˜ì§€ ì•Šì•˜ëŠ”ì§€ í‘í‘ì´ê°€ ê°ê¸°ì— ê±¸ë ¤ì„œ...', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' },
  { name: 'ì–‘ì–‘', text: 'ê¸°ì¹¨ì„ í•˜ë‹¤ê°€ ê·¸ë§Œ, ì œ ëˆˆì„ í† í•´ë²„ë ¸ì–´ìš”...!', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼2.png' },
Â  { name: '-', text: 'í™©ë‹¹í•œ ì´ì•¼ê¸°ì— ì´ë§ˆë¥¼ ì§šì—ˆë‹¤.', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼2.png' },
Â  { name: '-', text: 'ë­ë¼ê³  ìœ„ë¡œí•´ì•¼ í•˜ì§€?.', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼2.png', choice: 'B1' },
];

const branchB1 = [
  { name: 'ì–‘ì–‘', text: 'ì •ë§ì¸ê°€ìš”, ì¹´ë¼ì‚¬í‚¤ ë‹˜...?', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' }, 
  { name: 'ì¹´ë¼ì‚¬í‚¤', text: 'ë‹¹ì—°í•œ ê±¸ ê·¸ë ‡ê²Œê¹Œì§€;', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' }, 
  { name: 'ì–‘ì–‘', text: 'í•˜ì§€ë§Œ ì „ í‘í‘ì´ê°€ ëˆˆì„ ìƒì–´ë²„ë¦° ì´í›„ë¡œ ì•„ë¬´ê²ƒë„ ë³´ì´ì§€ ì•Šê²Œ ëìœ¼ë‹ˆê¹Œìš”...?', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' },
  { name: 'ì–‘ì–‘', text: 'ì•„ë¬´ ë„ì›€ë„ ë“œë¦´ ìˆ˜ ì—†ë‹¤êµ¬ìš”...?', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' },
  { name: '-', text: 'ì–´ì©ì§€ ê·¸ì € ì£¼ì €ì•‰ì•„ ìˆë”ë¼ë‹ˆ.' }, 
  { name: '-', text: 'ì´ìƒí•œ ì‹œì•¼ì—ëŠ” ì ì‘ë˜ì—ˆë‹¤ê³  í•´ë„ ë³´ì´ì§€ ì•ŠëŠ” ê±´ ë‹¤ë¥¸ ë¬¸ì œì¸ê°€.' }, 
  { name: 'ì¹´ë¼ì‚¬í‚¤', text: 'ë„ì›€ì€ ëìœ¼ë‹ˆê¹Œ ëŒì•„ê°€ì„œ ì‰¬ì–´ë¼.' },
  { name: 'ì¹´ë¼ì‚¬í‚¤', text: 'ì§‘ê¹Œì§€ ê°™ì´ ê°€ì§€.' },
  { name: 'ì–‘ì–‘', text: '...', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' }, 
  { name: 'ì–‘ì–‘', text: 'ì € ë„ì›€ì€ ì•ˆ ë˜ê² ì§€ë§Œ', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' }, 
  { name: 'ì–‘ì–‘', text: 'ê·¸ëƒ¥ ì¹´ë¼ì‚¬í‚¤ ë‹˜ê³¼ í•¨ê»˜ ìˆìœ¼ë©´ ì•ˆ ë ê¹Œìš”...?', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png', choice: 'C' }, 
];

const branchB2 = [
  { name: 'ì–‘ì–‘', text: 'ê·¸ê²Œ...', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼2.png' },
  { name: 'ì–‘ì–‘', text: 'ì•ì´ ë³´ì´ì§€ ì•ŠëŠ”ê±¸ìš”...?', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼2.png' },
  { name: 'ì¹´ë¼ì‚¬í‚¤', text: 'ì•ì´?', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼2.png' },
  { name: 'ì–‘ì–‘', text: 'í‘í‘ì´ê°€ ëˆˆì„ ìƒì–´ë²„ë¦° ì´í›„ë¡œ ë¬¸ì œê°€ ìƒê¸´ ê²ƒ ê°™ì•„ìš”...', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼2.png' },
  { name: '-', text: 'ì–´ì©ì§€ ê·¸ì € ì£¼ì €ì•‰ì•„ ìˆë”ë¼ë‹ˆ.' }, 
  { name: '-', text: 'ì´ìƒí•œ ì‹œì•¼ì—ëŠ” ì ì‘ë˜ì—ˆë‹¤ê³  í•´ë„ ë³´ì´ì§€ ì•ŠëŠ” ê±´ ë‹¤ë¥¸ ë¬¸ì œì¸ê°€.' }, 
  { name: 'ì¹´ë¼ì‚¬í‚¤', text: 'ëˆˆì€ ë‚´ê°€ ì°¾ì•„ë³¼ í…Œë‹ˆê¹Œ ëŒì•„ê°€ì„œ ì‰¬ì–´ë¼.' },
  { name: 'ì¹´ë¼ì‚¬í‚¤', text: 'ì§‘ê¹Œì§€ ê°™ì´ ê°€ì§€.' },
  { name: 'ì–‘ì–‘', text: '...', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' }, 
  { name: 'ì–‘ì–‘', text: 'ì € ë„ì›€ì€ ì•ˆ ë˜ê² ì§€ë§Œ', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' }, 
  { name: 'ì–‘ì–‘', text: 'ê·¸ëƒ¥ ì¹´ë¼ì‚¬í‚¤ ë‹˜ê³¼ í•¨ê»˜ ìˆìœ¼ë©´ ì•ˆ ë ê¹Œìš”...?', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png', choice: 'C' }, 
];

const branchC1 = [
  { name: 'ì–‘ì–‘', text: 'ë„¤...', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' },
  { name: 'SYSTEM', text: 'ë‹¹ì‹ ì€ ì–‘ì–‘ì„ ê·¸ì˜ ì§‘ê¹Œì§€ ë°”ë˜ë‹¤ ì£¼ì—ˆë‹¤.' },
  { name: 'SYSTEM', text: 'ëˆˆì— ë¯¼ê°í•˜ê²Œ êµ´ë˜ ì•…ë§ˆì˜€ìœ¼ë‹ˆ ì§€ê¸ˆì€ ì•ˆì •ì´ ë” í•„ìš”í•˜ë‹¤ íŒë‹¨í–ˆë˜ ê±°ì˜€ë‹¤.' }, 
  { name: 'SYSTEM', text: 'ê·¸ í›„ í˜¼ìì„œ ì–‘ì–‘ì˜ ëˆˆì„ ì°¾ì•„ë‹¤ë…”ìœ¼ë‚˜ ë„“ì€ í•˜ëŠ˜ì„ ì „ë¶€ ë’¤ì§€ê¸°ì—” ì—­ë¶€ì¡±ì´ì—ˆë‹¤.',
    img: 'ì´ë¯¸ì§€/ê²Œì„ì˜¤ë²„.png', end: true },
];

const branchC2 = [
  { name: 'ì¹´ë¼ì‚¬í‚¤', text: 'ê·¸ë˜. ì˜†ì— ìˆì–´ë¼. ë„¤ ëˆˆì¸ë° ë„¤ê°€ ë” ì˜ ì•Œê² ì§€...', img: 'ì´ë¯¸ì§€/ëˆˆë¬¼1.png' },
  { name: 'ì–‘ì–‘', text: 'ë„¤...!', img: 'ì´ë¯¸ì§€/ì›ƒìŒ.png' },
  { name: 'SYSTEM', text: 'ì–‘ì–‘ì´ ë‹¹ì‹ ì„ í–¥í•´ ì†ì„ ë‚´ë°€ì—ˆê³ , ë‹¹ì‹ ì€ ê·¸ ì†ì„ ë¶™ì¡ì•„ ìë¦¬ì—ì„œ ì¼ìœ¼ì¼œ ì£¼ì—ˆë‹¤.', img: 'ì´ë¯¸ì§€/ì›ƒìŒ.png' },
  { name: 'ì¹´ë¼ì‚¬í‚¤', text: 'ê·¸ëŸ¼ ì¼ë‹¨... ëˆˆì€ ì´ ìë¦¬ì—ì„œ ìƒì–´ë²„ë¦° ê±°ëƒ?', img: 'ì´ë¯¸ì§€/ì›ƒìŒ.png' },
  { name: 'ì–‘ì–‘', text: 'ë§ì•„ìš”. í•˜ì§€ë§Œ í‘í‘ì´ ë±‰ì–´ë²„ë¦¬ë©´ì„œ ë©€ë¦¬ ë‚ ì•„ê°€ë²„ë ¸ë‹¤ê³  ìƒê°í•´ìš”.', img: 'ì´ë¯¸ì§€/ì„œìš´.png' },
];
  

// ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
const nameEl  = document.getElementById('charName');
const textEl  = document.getElementById('dialogueText');
const imgEl   = document.getElementById('charImg');
const nextBtn = document.getElementById('nextBtn');
const dimOv   = document.getElementById('dimOverlay');
const choiceBox = document.getElementById('choiceBox');
const affVal  = document.getElementById('affectionValue');
const affFill = document.getElementById('affectionFill');
const affBox  = document.getElementById('affection');
const infoWin = document.getElementById('affectionInfo');
const infoTxt = document.getElementById('affectionInfoContent');
const infoX   = document.getElementById('closeAffectionInfo');
const bgElement = document.getElementById('background');

// í˜¸ê°ë„ ì„¤ëª… ë°˜í™˜
function affectionMessage(v){
  if(v >= 80) return 'ì‚¬ë‘í•´ì„œ ì£¼ì²´í•˜ì§€ ëª»í•˜ëŠ” ì¤‘.';
  if(v >= 50) return 'ì‚¬ë‘ìŠ¤ëŸ¬ìš´ ì—°ì¸ì´ë¼ê³  ìƒê°í•˜ëŠ” ì¤‘.';
  if(v >= 20) return 'ê³ ë§ˆìš´ ì—°ì¸ì´ë¼ê³  ìƒê°í•˜ëŠ” ì¤‘.';
  return 'ê·¸ì € ì—°ì¸ì´ë¼ê³  ìƒê°í•˜ëŠ” ì¤‘.';
}

// í˜¸ê°ë„ UI ì—…ë°ì´íŠ¸
function updateAffectionUI(){
  affVal.textContent = affection;
  affFill.style.width = `${affection}%`;
}

function updateDialogue() {
  const d = dialogues[index];
  nameEl.textContent = d.name;
  textEl.textContent = d.text;

  // âœ… ìºë¦­í„° ì´ë¯¸ì§€ ì²˜ë¦¬
  if (d.img) {
    imgEl.src = d.img;
    imgEl.style.display = 'block'; // ì´ë¯¸ì§€ í‘œì‹œ
  } else {
    imgEl.style.display = 'none';  // ì´ë¯¸ì§€ ìˆ¨ê¹€
  }

  // âœ… ë‚ ì§œ ì—…ë°ì´íŠ¸
  if (d.date) {
    document.getElementById('gameDate').textContent = d.date;
  }

  // âœ… ì–´ë‘ìš´ í™”ë©´ ì—°ì¶œ
  dimOv.style.display = d.dim ? 'block' : 'none';


  // âœ… ë°°ê²½ ì´ë¯¸ì§€ ë³€ê²½
  if (d.bg) {
    bgElement.src = d.bg;

    // ì»·ì”¬ ë°°ê²½ì¸ ê²½ìš° (íŒŒì¼ëª…ì— 'ì»·ì”¬'ì´ í¬í•¨ëœ ê²½ìš°)
    if (d.bg.includes('ì»·ì”¬')) {
      bgElement.classList.remove('blur-bg');
      bgElement.classList.add('no-blur');
    } else {
      bgElement.classList.remove('no-blur');
      bgElement.classList.add('blur-bg');
    }
  }

  dimOv.style.display = d.dim ? 'block' : 'none';
}

// ì„ íƒì§€ í‘œì‹œ ì—¬ë¶€ íŒë‹¨
function maybeShowChoice() {
  const d = dialogues[index];
  
  if (d.choice === true) {
    choiceBox.innerHTML = `
      <button onclick="choose(-5, 'A')">ì ì—ì„œ ê¹¬ ì˜¤ë§ˆì—ë¥¼ ë‹¬ë˜ì¤€ë‹¤.</button>
      <button onclick="choose(10, 'B')">ëª©ì†Œë¦¬ì˜ ì¶œì²˜ë¥¼ ì°¾ì•„ê°„ë‹¤.</button>
    `;
    choiceBox.style.display = 'flex';
    nextBtn.style.display = 'none';
    choiceShown = true;
    
   } else if (d.choice === 'B1') {
    choiceBox.innerHTML = `
      <button onclick="choose(5, 'B1')">ì°¾ì•„ì¤„ í…Œë‹ˆê¹Œ ì§„ì •í•´ë¼.</button>
      <button onclick="choose(-5, 'B2')">ì°¾ì•„ì•¼ì§€ ì™œ ì£¼ì €ì•‰ì•„ ìˆëŠ” ê±°ëƒ.</button>
    `;
    choiceBox.style.display = 'flex';
    nextBtn.style.display = 'none';
    choiceShown = true;
    
    } else if (d.choice === 'C') {
    choiceBox.innerHTML = `
      <button onclick="choose(3, 'C1')">ì§‘ì—ì„œ ì‰¬ëŠ” ê²Œ ì•ˆì „í•  ê±°ë‹¤...</button>
      <button onclick="choose(5, 'C2')">ì–‘ì–‘ì´ ë„ì›€ì´ ë ì§€ë„ ëª¨ë¥¸ë‹¤...</button>
    `;
    choiceBox.style.display = 'flex';
    nextBtn.style.display = 'none';
    choiceShown = true;
  }
}

// ì„ íƒì§€ ì²˜ë¦¬
function choose(delta, branch){
  affection = Math.max(0, Math.min(100, affection + delta));
  updateAffectionUI();
  choiceBox.style.display = 'none';
  nextBtn.style.display = 'block';
  choiceShown = false;

  if (branch === 'A')      dialogues = branchA;
  else if (branch === 'B') dialogues = branchB;
  else if (branch === 'B1') dialogues = branchB1;
  else if (branch === 'B2') dialogues = branchB2;
  else if (branch === 'C1') dialogues = branchC1;
  else if (branch === 'C2') dialogues = branchC2;

  index = 0;
  updateDialogue();
  maybeShowChoice();
}

// ë‹¤ìŒ ë²„íŠ¼ ë™ì‘
nextBtn.addEventListener('click', () => {
  if (choiceShown) return;
  index++;
  if (index < dialogues.length) {
    updateDialogue();
    maybeShowChoice();
  } else {
    const d = dialogues[index - 1];
    if (d.end) {
      alert('ë°°ë“œ ì—”ë”©ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.');
      location.reload();
    } else {
      alert('í”Œë ˆì´í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.');
    }
  }
});

// í˜¸ê°ë„ ë°•ìŠ¤ í´ë¦­ ì‹œ ì •ë³´ íŒì—… í‘œì‹œ
affBox.addEventListener('click', ()=>{
  infoTxt.innerHTML = `í˜„ì¬ í˜¸ê°ë„ëŠ” ${affection}ì…ë‹ˆë‹¤.<br>ë‹¹ì‹ ì„ ${affectionMessage(affection)}`;
  infoWin.style.display = 'block';
});
infoX.addEventListener('click', ()=> infoWin.style.display = 'none');

// ì´ˆê¸° ì‹¤í–‰
updateAffectionUI();
updateDialogue();
</script>

</body>
</html>
